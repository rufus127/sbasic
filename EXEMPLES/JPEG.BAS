  100 INPUT "Fichier JPEG … charger"; FILE$
  110 OPEN LIBRARY "sbjpeg.dll" AS 10
  120 FILE1$=FILE$+".JPG":WIDTH%=XPEN:HEIGHT%=YPEN
  130 CALL #10 "JpegLoad"(FILE1$, BMP$, WIDTH%, HEIGHT%)
  140 WIDTH%=CVT$%(MID$(BMP$,19,4))
  150 HEIGHT%=CVT$%(MID$(BMP$,23,4))
  160 GR WIDTH%,HEIGHT%
  170 GPUT BMP$,0,0
  180 CALL PALETTE(BMP$)
  190 FILE1$=FILE$+"256.JPG"
  200 CALL #10 "JpegSave" (FILE1$, BMP$)
  240 CLOSE 10
  245 A$=INCH$(0)
  250 END
 1000 SUB PALETTE(IMAGE$)
 1010 IF LEN(IMAGE$)>=54 GOTO 1030
 1020 PRINT "Image BMP non reconnue":END
 1030 IF MID$(IMAGE$,1,2)<>"BM" OR CVT$%(MID$(IMAGE$,3,4))<>LEN(IMAGE$) OR CVT$%(MID$(IMAGE$,27,4))<>8*65536+1 GOTO 1020
 1040 IMAGEOFFSET%=CVT$%(MID$(IMAGE$,11,4))+1
 1050 PALETTEOFFSET%=CVT$%(MID$(IMAGE$,15,4))+15
 1060 IF PALETTEOFFSET%<55 OR IMAGEOFFSET%<PALETTEOFFSET%+256*4 OR IMAGEOFFSET%>LEN(IMAGE$) GOTO 1020
 1070 FOR I%=0 TO 255
 1080 RGB%=CVT$%(MID$(IMAGE$,PALETTEOFFSET%+I%*4,4))
 1090 SETCOLOR I%,RGB%/65536 AND 255,RGB%/256 AND 255,RGB% AND 255 
 1100 NEXT I%
 1110 RETURN
