   10 BLOAD "repasc-fix.bmp" BMP$
   20 GR 1000,600
   30 GPUT BMP$,50,0
   40 CALL PALETTE(BMP$)
   50 END
  100 SUB PALETTE(IMAGE$)
  110 IF LEN(IMAGE$)>=54 GOTO 130
  120 PRINT "Image BMP non reconnue":END
  130 IF MID$(IMAGE$,1,2)<>"BM" OR CVT$%(MID$(IMAGE$,3,4))<>LEN(IMAGE$) OR CVT$%(MID$(IMAGE$,27,4))<>8*65536+1 GOTO 120
  140 IMAGEOFFSET%=CVT$%(MID$(IMAGE$,11,4))+1
  150 PALETTEOFFSET%=CVT$%(MID$(IMAGE$,15,4))+15
  160 IF PALETTEOFFSET%<55 OR IMAGEOFFSET%<PALETTEOFFSET%+256*4 OR IMAGEOFFSET%>LEN(IMAGE$) GOTO 120
  170 FOR I%=0 TO 255
  180 RGB%=CVT$%(MID$(IMAGE$,PALETTEOFFSET%+I%*4,4))
  190 SETCOLOR I%,RGB%/65536 AND 255,RGB%/256 AND 255,RGB% AND 255 
  200 NEXT I%
  210 RETURN
